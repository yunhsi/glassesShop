import{c as h,aa as g,V as r,W as a,X as t,_ as i,aR as b,ah as l,ag as x,ac as k,aK as v,ar as w,ae as S,Z as P}from"./vendor-hbc7ZpyS.js";import{b as C}from"./vue-router-B-VbIHpu.js";import{a as B,b as $,d as D,_ as V,c as N}from"./index-BLmSvNjp.js";import{d as T}from"./pinia-BUsbKMiz.js";import{S as u}from"./sweetalert2-BY1s0Tb6.js";function I(s){const o=new Date(s*1e3);return`${o.getFullYear()}-${o.getMonth()+1}-${o.getDate()} ${o.getHours()}:${o.getMinutes()}`}const M={postPay(s){return B.post(`/pay/${s}`).then(o=>o.data)}},O=T("usePay",()=>{const s=$(),o=D();return{postPay:async c=>{s.isLoading=!0;try{const d=await M.postPay(c);u.fire({icon:"success",title:`${d.message}`,showConfirmButton:!1,timer:1500}),await o.getOrders()}catch(d){u.fire({icon:"error",title:`${d.message}`})}finally{s.isLoading=!1}}}}),q={class:"border border-danger p-4 rounded custom-shadow mt-4 mt-md-0"},z={class:"pb-2",style:{"font-size":"12px",display:"block"}},L={class:"border-bottom"},R={key:0,class:"text-end border-0 px-0"},j={class:"border-bottom"},A={key:0,class:"text-end border-0 px-0"},E={class:"border-bottom"},F={key:0,class:"text-end border-0 px-0"},H={class:"border-bottom"},K={key:0,class:"text-end border-0 px-0"},W={class:"border-bottom"},X={class:"text-end border-0 px-0"},Y={key:0,class:"badge rounded-pill bg-success"},Z={key:1,class:"badge rounded-pill bg-secondary"},G={key:0,class:"d-grid gap-2"},J={key:1,class:"d-grid gap-2"},Q={__name:"PaymentInfo",props:{id:{type:String,required:!0},order:{type:Object,default:()=>({})},isPaid:{type:Boolean,default:!1}},setup(s){const o=C(),m=N(),c=O(),d=s,n=h(()=>d.order.user),f=()=>{u.fire({title:"是否確定結帳?",icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3534",cancelButtonText:"取消",confirmButtonText:"是的！"}).then(p=>{p.isConfirmed&&y()})},y=async()=>{await c.postPay(d.id),o.push(`/checkout/${d.id}`)};return(p,e)=>{const _=g("router-link");return r(),a("div",q,[e[6]||(e[6]=t("h4",{class:"mb-1"},"訂購資訊",-1)),t("small",z," 建立時間："+i(b(I)(s.order.create_at)),1),t("table",{class:x(["table mb-4 small",{"table-dark":b(m).isDarkMode}])},[t("tbody",null,[t("tr",L,[e[0]||(e[0]=t("th",{class:"border-0 px-0 fw-normal"},"收件人姓名",-1)),n.value?(r(),a("td",R,i(n.value.name),1)):l("",!0)]),t("tr",j,[e[1]||(e[1]=t("th",{class:"border-0 px-0 fw-normal"},"收件人電話",-1)),n.value?(r(),a("td",A,i(n.value.tel),1)):l("",!0)]),t("tr",E,[e[2]||(e[2]=t("th",{class:"border-0 px-0 fw-normal"},"收件人地址",-1)),n.value?(r(),a("td",F,i(n.value.address),1)):l("",!0)]),t("tr",H,[e[3]||(e[3]=t("th",{class:"border-0 px-0 fw-normal"},"付款方式",-1)),n.value?(r(),a("td",K,i(n.value.payment),1)):l("",!0)]),t("tr",W,[e[4]||(e[4]=t("th",{class:"border-0 px-0 fw-normal"},"付款狀態",-1)),t("td",X,[s.order.is_paid?(r(),a("span",Y,"付款完成")):(r(),a("span",Z,"尚未付款"))])])])],2),k(t("div",null,[s.order.is_paid?(r(),a("div",J,[w(_,{to:"/products",class:"btn btn-danger",prefetch:""},{default:S(()=>e[5]||(e[5]=[P("回到商品頁")])),_:1})])):(r(),a("div",G,[t("button",{type:"button",class:"btn btn-danger",onClick:f},"結帳去")]))],512),[[v,!s.isPaid]])])}}},rt=V(Q,[["__scopeId","data-v-e58901c0"]]);export{rt as P};
