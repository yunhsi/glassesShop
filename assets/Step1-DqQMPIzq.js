import{C as L}from"./CheckoutSteps-bjcjEBoh.js";import{a as N,u as S,b as w,_ as B,c as T}from"./index-BX0knjW9.js";import{d as G}from"./pinia-Do-HvM91.js";import{aU as M,r as g,x as U,w as j,bb as z,U as n,V as t,ap as c,ae as u,aN as A,am as E,an as R,X as m,Y as i,af as q,ac as v,bj as F,a8 as h,T as d}from"./vendor-BUxCYPUO.js";import"./axios-DWwaMX5J.js";import"./primevue--IhQ8n2h.js";import"./vee-validate-B-F8cbDQ.js";const H={useCoupon(p){return N.post("/coupon",{data:p}).then(a=>a.data)}},W=G("useCoupon",()=>{const p=S(),a=w();return{useCoupon:async _=>{a.isLoading=!0;try{await H.useCoupon(_),await p.getCarts()}catch(b){M.fire({icon:"error",title:`${b.message}`})}finally{a.isLoading=!1}}}}),X={style:{"padding-top":"70px","min-height":"calc(100vh - 104px)"}},Y={class:"container pt-4 pb-5"},J={class:"row pt-2"},K={class:"col-12"},O={scope:"row",class:"border-0 fw-normal py-3 mobile-hide"},P=["src"],Q={class:"border-0 align-middle"},Z={class:"border-0 align-middle text-center"},tt={class:"border-0 align-middle"},et={class:"border-0 align-middle"},ot={class:"border-0 align-middle text-center"},st=["onClick"],at={key:1,class:"py-5"},rt={class:"row py-3"},lt={class:"col-md-6"},nt={class:"input-group input-group"},ct={key:0,class:"col-md-6 text-end h5 m-0 mt-4 mt-md-0"},dt={class:"text-end"},it={__name:"Step1",setup(p){const a=F(),r=S(),_=W(),b=T(),x=w(),s=g(),l=g(""),k=g(localStorage.getItem("isGetCoupon"));U(()=>{k.value==="true"&&(l.value="happy99",C()),s.value=r.carsData}),j(r,()=>{r.carsData.carts.length||(localStorage.setItem("isGetCoupon",!1),l.value=""),s.value=r.carsData});const V=async y=>{await r.deleteCart(y)},C=async()=>{l.value==="happy99"?(await _.useCoupon(l.value),localStorage.setItem("isGetCoupon",!0)):x.showMsg("error","找不到優惠券")},D=()=>{s.value.carts.length?a.push("/order"):x.showMsg("warn","購物車內沒有商品")};return z({title:"購物車｜!WEAR"}),(y,e)=>{const f=h("router-link"),$=h("VInputText"),I=h("VButton");return d(),n("main",X,[t("div",Y,[c(L,{step:"1"}),t("div",J,[t("div",K,[s.value&&s.value.carts.length?(d(),n("table",{key:0,class:u(["table table-hover",{"table-dark":A(b).isDarkMode}])},[t("tbody",null,[e[2]||(e[2]=t("tr",{class:"border-bottom fw-bold small"},[t("td",{scope:"col",class:"border-0"},"品名"),t("td",{scope:"col",class:"border-0 mobile-hide"}),t("td",{scope:"col",class:"border-0 text-center mobile-width"},"數量"),t("td",{scope:"col",class:"border-0 text-center"},"單價"),t("td",{scope:"col",class:"border-0 text-center"},"小計"),t("td",{scope:"col",class:"border-0"})],-1)),(d(!0),n(E,null,R(s.value.carts,o=>(d(),n("tr",{key:o.id,class:"list-hover border-bottom"},[t("td",O,[c(f,{to:`/product/${o.product_id}`,prefetch:""},{default:v(()=>[t("img",{src:o.product.image,alt:"",class:"rounded"},null,8,P)]),_:2},1032,["to"])]),t("td",Q,[c(f,{to:`/product/${o.product_id}`,style:{"text-transform":"capitalize"},prefetch:""},{default:v(()=>[m(i(o.product.title),1)]),_:2},1032,["to"])]),t("td",Z,i(o.qty),1),t("td",tt,[t("p",{class:u(["mb-0 text-end",{onsale:o.final_total!=o.product.price}])}," $"+i(o.product.price.toLocaleString()),3)]),t("td",et,[t("p",{class:u(["mb-0 text-end",{"text-danger":o.final_total!=o.product.price}])}," $"+i(o.final_total.toLocaleString()),3)]),t("td",ot,[t("a",{href:"javascript:;",class:"close",onClick:pt=>V(o.id)},e[1]||(e[1]=[t("i",{class:"pi pi-times-circle"},null,-1)]),8,st)])]))),128))])],2)):(d(),n("div",at,e[3]||(e[3]=[t("p",{class:"text-center",style:{"letter-spacing":"2px"}},"購物車內沒有商品",-1)]))),t("div",rt,[t("div",lt,[e[4]||(e[4]=t("p",{class:"h6 mb-2 small"},"➤ 開店慶輸入優惠碼 happy99 即可享九折優惠",-1)),t("div",nt,[c($,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),type:"text",placeholder:"請輸入優惠碼",class:"form-control text-danger",style:{"letter-spacing":"1px"}},null,8,["modelValue"]),c(I,{label:"套用優惠碼",severity:"contrast",onClick:C})])]),s.value?(d(),n("div",ct,[t("p",null,[e[5]||(e[5]=m(" 總金額： ")),t("span",{class:u({"text-danger":s.value.final_total!=s.value.total})}," $"+i(s.value.final_total.toLocaleString()),3),e[6]||(e[6]=m(" 元 "))])])):q("",!0)]),e[8]||(e[8]=t("hr",null,null,-1)),t("div",dt,[c(f,{to:"/products",class:"btn btn-outline-secondary me-3 px-4",prefetch:""},{default:v(()=>e[7]||(e[7]=[m(" 繼續購物 ")])),_:1}),t("button",{type:"button",class:"btn btn-danger px-4",onClick:D},"前往結帳")])])])])])}}},ht=B(it,[["__scopeId","data-v-330faf48"]]);export{ht as default};
