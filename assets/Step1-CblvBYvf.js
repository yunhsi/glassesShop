import{C as z}from"./CheckoutSteps-C_r3muZW.js";import{F as B}from"./Footer-B-IekEGI.js";import{a as N,u as w,b as k,_ as G,c as M}from"./index-BLmSvNjp.js";import{d as T}from"./pinia-BUsbKMiz.js";import{S as F}from"./sweetalert2-BY1s0Tb6.js";import{b as R}from"./vue-router-B-VbIHpu.js";import{r as f,z as A,w as E,b6 as W,W as c,X as t,ar as a,ag as u,aR as j,ao as S,ap as q,Z as m,_ as i,ah as H,ae as v,aa as h,V as d}from"./vendor-hbc7ZpyS.js";import"./axios-DWwaMX5J.js";import"./primevue-DbMZqESr.js";import"./aos-BOscYbde.js";import"./vee-validate-C24gywMW.js";import"./fontawesome-Bt4LmCzt.js";/* empty css                  */const U={useCoupon(p){return N.post("/coupon",{data:p}).then(r=>r.data)}},X=T("useCoupon",()=>{const p=w(),r=k();return{useCoupon:async _=>{r.isLoading=!0;try{await U.useCoupon(_),await p.getCarts()}catch(b){F.fire({icon:"error",title:`${b.message}`})}finally{r.isLoading=!1}}}}),Z={style:{"padding-top":"70px","min-height":"calc(100vh - 104px)"},"data-aos":"fade-zoom-in","data-aos-easing":"ease-in-sine","data-aos-duration":"300","data-aos-delay":"300"},J={class:"container pt-4 pb-5"},K={class:"row pt-2"},O={class:"col-12"},P={scope:"row",class:"border-0 fw-normal py-3 mobile-hide"},Q=["src"],Y={class:"border-0 align-middle"},tt={class:"border-0 align-middle text-center"},ot={class:"border-0 align-middle"},et={class:"border-0 align-middle"},st={class:"border-0 align-middle text-center"},at=["onClick"],rt={key:1,class:"py-5"},lt={class:"row py-3"},nt={class:"col-md-6"},ct={class:"input-group input-group"},dt={key:0,class:"col-md-6 text-end h5 m-0 mt-4 mt-md-0"},it={class:"text-end"},pt={__name:"Step1",setup(p){const r=R(),l=w(),_=X(),b=M(),x=k(),s=f(),n=f(""),V=f(localStorage.getItem("isGetCoupon"));A(()=>{V.value==="true"&&(n.value="happy99",y()),s.value=l.carsData}),E(l,()=>{l.carsData.carts.length||(localStorage.setItem("isGetCoupon",!1),n.value=""),s.value=l.carsData});const D=async C=>{await l.deleteCart(C)},y=async()=>{n.value==="happy99"?(await _.useCoupon(n.value),localStorage.setItem("isGetCoupon",!0)):x.showMsg("error","找不到優惠券")},$=()=>{s.value.carts.length?r.push("/order"):x.showMsg("warn","購物車內沒有商品")};return W({title:"購物車｜!WEAR"}),(C,o)=>{const g=h("router-link"),I=h("VInputText"),L=h("VButton");return d(),c(S,null,[t("main",Z,[t("div",J,[a(z,{step:"1"}),t("div",K,[t("div",O,[s.value&&s.value.carts.length?(d(),c("table",{key:0,class:u(["table table-hover",{"table-dark":j(b).isDarkMode}])},[t("tbody",null,[o[2]||(o[2]=t("tr",{class:"border-bottom fw-bold small"},[t("td",{scope:"col",class:"border-0"},"品名"),t("td",{scope:"col",class:"border-0 mobile-hide"}),t("td",{scope:"col",class:"border-0 text-center mobile-width"},"數量"),t("td",{scope:"col",class:"border-0 text-center"},"單價"),t("td",{scope:"col",class:"border-0 text-center"},"小計"),t("td",{scope:"col",class:"border-0"})],-1)),(d(!0),c(S,null,q(s.value.carts,e=>(d(),c("tr",{key:e.id,class:"list-hover border-bottom"},[t("td",P,[a(g,{to:`/product/${e.product_id}`},{default:v(()=>[t("img",{src:e.product.image,loading:"lazy",alt:"",class:"rounded"},null,8,Q)]),_:2},1032,["to"])]),t("td",Y,[a(g,{to:`/product/${e.product_id}`,style:{"text-transform":"capitalize"}},{default:v(()=>[m(i(e.product.title),1)]),_:2},1032,["to"])]),t("td",tt,i(e.qty),1),t("td",ot,[t("p",{class:u(["mb-0 text-end",{onsale:e.final_total!=e.product.price}])}," $"+i(e.product.price.toLocaleString()),3)]),t("td",et,[t("p",{class:u(["mb-0 text-end",{"text-danger":e.final_total!=e.product.price}])}," $"+i(e.final_total.toLocaleString()),3)]),t("td",st,[t("a",{href:"javascript:;",class:"close",onClick:ut=>D(e.id)},o[1]||(o[1]=[t("i",{class:"pi pi-times-circle"},null,-1)]),8,at)])]))),128))])],2)):(d(),c("div",rt,o[3]||(o[3]=[t("p",{class:"text-center",style:{"letter-spacing":"2px"}},"購物車內沒有商品",-1)]))),t("div",lt,[t("div",nt,[o[4]||(o[4]=t("p",{class:"h6 mb-2 small"},"➤ 開店慶輸入優惠碼 happy99 即可享九折優惠",-1)),t("div",ct,[a(I,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value=e),type:"text",placeholder:"請輸入優惠碼",class:"form-control text-danger",style:{"letter-spacing":"1px"}},null,8,["modelValue"]),a(L,{label:"套用優惠碼",severity:"contrast",onClick:y})])]),s.value?(d(),c("div",dt,[t("p",null,[o[5]||(o[5]=m(" 總金額： ")),t("span",{class:u({"text-danger":s.value.final_total!=s.value.total})}," $"+i(s.value.final_total.toLocaleString()),3),o[6]||(o[6]=m(" 元 "))])])):H("",!0)]),o[8]||(o[8]=t("hr",null,null,-1)),t("div",it,[a(g,{to:"/products",class:"btn btn-outline-secondary me-3 px-4",prefetch:""},{default:v(()=>o[7]||(o[7]=[m(" 繼續購物 ")])),_:1}),t("button",{type:"button",class:"btn btn-danger px-4",onClick:$},"前往結帳")])])])])]),a(B)],64)}}},Vt=G(pt,[["__scopeId","data-v-3c834c71"]]);export{Vt as default};
