import{T as l,U as b,V as d,Y as h,ae as k,X as S,af as V,am as L,f as T,a8 as m,ab as f,ac as u,ap as v,bi as x,r as i,aU as P}from"./vendor-BUxCYPUO.js";import{_ as A,u as B,a as y,b as D}from"./index-BX0knjW9.js";import{d as N}from"./pinia-Do-HvM91.js";const j={key:0,class:"price"},O={__name:"Price",props:{product:{type:Object,default:()=>{}}},setup(t){return(o,r)=>(l(),b(L,null,[d("span",{class:k(["originPrice",{onsale:t.product.origin_price!=t.product.price}])}," NTD "+h(t.product.origin_price.toLocaleString()),3),t.product.origin_price!=t.product.price?(l(),b("span",j,[r[0]||(r[0]=S("   ")),r[1]||(r[1]=d("i",{class:"pi pi-arrow-right"},null,-1)),S("   NTD "+h(t.product.price.toLocaleString()),1)])):V("",!0)],64))}},z=A(O,[["__scopeId","data-v-25a2655e"]]),E={class:"d-flex gap-1 p-1 justify-content-end position-absolute start-0 end-0"},M=["src"],U={class:"mt-1"},I={__name:"ProductCard",props:{product:{type:Object,default:()=>({})},rootClass:{type:String,default:""}},setup(t){const o=B(),r=t,p=T(()=>{const s=(r.product.price/r.product.origin_price-1)*100;return Math.round(s)}),g=async(s,c=1)=>{const n={product_id:s,qty:c};await o.postCart(n)};return(s,c)=>{const n=m("VTag"),w=m("VButton"),_=m("VCard"),$=m("router-link");return l(),f($,{to:`/product/${t.product.id}`},{default:u(()=>[v(_,{class:k(["hvr-float product-card m-4",t.rootClass])},{header:u(()=>[d("div",E,[t.product.unit?(l(),f(n,{key:0,severity:"danger",value:"HOT"})):V("",!0),t.product.price!=t.product.origin_price?(l(),f(n,{key:1,severity:"warn",value:`SALE ${p.value}%`},null,8,["value"])):V("",!0)]),d("img",{src:t.product.image,alt:""},null,8,M)]),title:u(()=>[S(h(t.product.title),1)]),subtitle:u(()=>[v(z,{product:t.product},null,8,["product"])]),footer:u(()=>[d("div",U,[v(w,{label:"加入購物車",severity:"danger",outlined:"",size:"small",class:"w-100",onClick:c[0]||(c[0]=x(a=>g(t.product.id),["stop","prevent"]))})])]),_:1},8,["class"])]),_:1},8,["to"])}}},C={getProducts(t){return y.get(`/products?page=${t}`).then(o=>o.data)},getAllProducts(){return y.get("/products/all").then(t=>t.data.products)},getProduct(t){return y.get(`/product/${t}`).then(o=>o.data)}},R=N("useProduct",()=>{const t=D(),o=i([]),r=i([]),p=i({}),g=i(),s=i(),c=i(),n=i();return{productsData:o,allProductsData:r,recommendationProducts:g,saleProducts:s,glassesProducts:c,sunGlassesProducts:n,productData:p,getProducts:async a=>{t.isLoading=!0;try{o.value=await C.getProducts(a)}catch(e){P.fire({icon:"error",title:`${e.message}`})}finally{t.isLoading=!1}},getAllProducts:async()=>{t.isLoading=!0;try{const a=await C.getAllProducts();r.value=a.filter(e=>e.is_enabled===!0),g.value=r.value.filter(e=>e.unit===!0),s.value=r.value.filter(e=>e.price!=e.origin_price),c.value=r.value.filter(e=>e.category==="光學眼鏡"),n.value=r.value.filter(e=>e.category==="太陽眼鏡")}catch(a){P.fire({icon:"error",title:`${a.message}`})}finally{t.isLoading=!1}},getProduct:async a=>{t.isLoading=!0;try{const e=await C.getProduct(a);p.value=e.product}catch(e){P.fire({icon:"error",title:`${e.message}`})}finally{t.isLoading=!1}}}});export{z as P,I as _,R as u};
