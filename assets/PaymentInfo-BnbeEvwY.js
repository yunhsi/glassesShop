import{aU as u,bi as h,f as g,a8 as x,T as r,U as a,V as t,Y as i,aN as b,af as l,ae as k,aa as v,aI as w,ap as S,ac as P,X as C}from"./vendor-CeIIztvN.js";import{a as B,b as $,d as D,_ as N,c as T}from"./index-DrLUoZcZ.js";import{d as V}from"./pinia-f5aTiCRI.js";function I(s){const o=new Date(s*1e3);return`${o.getFullYear()}-${o.getMonth()+1}-${o.getDate()} ${o.getHours()}:${o.getMinutes()}`}const M={postPay(s){return B.post(`/pay/${s}`).then(o=>o.data)}},O=V("usePay",()=>{const s=$(),o=D();return{postPay:async c=>{s.isLoading=!0;try{const d=await M.postPay(c);u.fire({icon:"success",title:`${d.message}`,showConfirmButton:!1,timer:1500}),await o.getOrders()}catch(d){u.fire({icon:"error",title:`${d.message}`})}finally{s.isLoading=!1}}}}),q={class:"border border-danger p-4 rounded custom-shadow mt-4 mt-md-0"},z={class:"pb-2",style:{"font-size":"12px",display:"block"}},L={class:"border-bottom"},U={key:0,class:"text-end border-0 px-0"},Y={class:"border-bottom"},j={key:0,class:"text-end border-0 px-0"},A={class:"border-bottom"},E={key:0,class:"text-end border-0 px-0"},F={class:"border-bottom"},H={key:0,class:"text-end border-0 px-0"},R={class:"border-bottom"},X={class:"text-end border-0 px-0"},G={key:0,class:"badge rounded-pill bg-success"},J={key:1,class:"badge rounded-pill bg-secondary"},K={key:0,class:"d-grid gap-2"},Q={key:1,class:"d-grid gap-2"},W={__name:"PaymentInfo",props:{id:{type:String,required:!0},order:{type:Object,default:()=>({})},isPaid:{type:Boolean,default:!1}},setup(s){const o=h(),m=T(),c=O(),d=s,n=g(()=>d.order.user),f=()=>{u.fire({title:"是否確定結帳?",icon:"question",showCancelButton:!0,confirmButtonColor:"#dc3534",cancelButtonText:"取消",confirmButtonText:"是的！"}).then(p=>{p.isConfirmed&&y()})},y=async()=>{await c.postPay(d.id),o.push(`/checkout/${d.id}`)};return(p,e)=>{const _=x("router-link");return r(),a("div",q,[e[6]||(e[6]=t("h4",{class:"mb-1"},"訂購資訊",-1)),t("small",z," 建立時間："+i(b(I)(s.order.create_at)),1),t("table",{class:k(["table mb-4 small",{"table-dark":b(m).isDarkMode}])},[t("tbody",null,[t("tr",L,[e[0]||(e[0]=t("th",{class:"border-0 px-0 fw-normal"},"收件人姓名",-1)),n.value?(r(),a("td",U,i(n.value.name),1)):l("",!0)]),t("tr",Y,[e[1]||(e[1]=t("th",{class:"border-0 px-0 fw-normal"},"收件人電話",-1)),n.value?(r(),a("td",j,i(n.value.tel),1)):l("",!0)]),t("tr",A,[e[2]||(e[2]=t("th",{class:"border-0 px-0 fw-normal"},"收件人地址",-1)),n.value?(r(),a("td",E,i(n.value.address),1)):l("",!0)]),t("tr",F,[e[3]||(e[3]=t("th",{class:"border-0 px-0 fw-normal"},"付款方式",-1)),n.value?(r(),a("td",H,i(n.value.payment),1)):l("",!0)]),t("tr",R,[e[4]||(e[4]=t("th",{class:"border-0 px-0 fw-normal"},"付款狀態",-1)),t("td",X,[s.order.is_paid?(r(),a("span",G,"付款完成")):(r(),a("span",J,"尚未付款"))])])])],2),v(t("div",null,[s.order.is_paid?(r(),a("div",Q,[S(_,{to:"/products",class:"btn btn-danger",prefetch:""},{default:P(()=>e[5]||(e[5]=[C("回到商品頁")])),_:1})])):(r(),a("div",K,[t("button",{type:"button",class:"btn btn-danger",onClick:f},"結帳去")]))],512),[[w,!s.isPaid]])])}}},st=N(W,[["__scopeId","data-v-e58901c0"]]);export{st as P};
