import{C as B}from"./CheckoutSteps-BeDcuVDr.js";import{F as N}from"./Footer-B1uIpLyl.js";import{a as T,u as w,b as k,_ as z,c as G}from"./index-iMdEkF3s.js";import{d as M}from"./pinia-BkvZVVYd.js";import{S as A}from"./sweetalert2-BY1s0Tb6.js";import{b as F}from"./vue-router-CBWtc_xm.js";import{r as f,A as j,w as q,b8 as E,Y as c,Z as t,at as a,ai as u,aT as R,aq as S,ar as H,$ as m,a0 as i,aj as U,ag as v,ac as h,X as d}from"./vendor-B41E6fCd.js";import"./axios-DWwaMX5J.js";import"./primevue-CFhGeXvP.js";import"./aos-BOscYbde.js";import"./vee-validate-Cb4b_jUY.js";import"./fontawesome-_oGGVkH_.js";import"./bootstrap-TFU0-Fi5.js";const W={useCoupon(p){return T.post("/coupon",{data:p}).then(r=>r.data)}},X=M("useCoupon",()=>{const p=w(),r=k();return{useCoupon:async _=>{r.isLoading=!0;try{await W.useCoupon(_),await p.getCarts()}catch(b){A.fire({icon:"error",title:`${b.message}`})}finally{r.isLoading=!1}}}}),Y={style:{"padding-top":"70px","min-height":"calc(100vh - 104px)"},"data-aos":"fade-zoom-in","data-aos-easing":"ease-in-sine","data-aos-duration":"300","data-aos-delay":"300"},Z={class:"container pt-4 pb-5"},J={class:"row pt-2"},K={class:"col-12"},O={scope:"row",class:"border-0 fw-normal py-3 mobile-hide"},P=["src"],Q={class:"border-0 align-middle"},tt={class:"border-0 align-middle text-center"},ot={class:"border-0 align-middle"},et={class:"border-0 align-middle"},st={class:"border-0 align-middle text-center"},at=["onClick"],rt={key:1,class:"py-5"},lt={class:"row py-3"},nt={class:"col-md-6"},ct={class:"input-group input-group"},dt={key:0,class:"col-md-6 text-end h5 m-0 mt-4 mt-md-0"},it={class:"text-end"},pt={__name:"Step1",setup(p){const r=F(),l=w(),_=X(),b=G(),x=k(),s=f(),n=f(""),V=f(localStorage.getItem("isGetCoupon"));j(()=>{V.value==="true"&&(n.value="happy99",y()),s.value=l.carsData}),q(l,()=>{l.carsData.carts.length||(localStorage.setItem("isGetCoupon",!1),n.value=""),s.value=l.carsData});const $=async C=>{await l.deleteCart(C)},y=async()=>{n.value==="happy99"?(await _.useCoupon(n.value),localStorage.setItem("isGetCoupon",!0)):x.showMsg("error","找不到優惠券")},D=()=>{s.value.carts.length?r.push("/order"):x.showMsg("warn","購物車內沒有商品")};return E({title:"購物車｜!WEAR"}),(C,o)=>{const g=h("router-link"),I=h("VInputText"),L=h("VButton");return d(),c(S,null,[t("main",Y,[t("div",Z,[a(B,{step:"1"}),t("div",J,[t("div",K,[s.value&&s.value.carts.length?(d(),c("table",{key:0,class:u(["table table-hover",{"table-dark":R(b).isDarkMode}])},[t("tbody",null,[o[2]||(o[2]=t("tr",{class:"border-bottom fw-bold small"},[t("td",{scope:"col",class:"border-0"},"品名"),t("td",{scope:"col",class:"border-0 mobile-hide"}),t("td",{scope:"col",class:"border-0 text-center mobile-width"},"數量"),t("td",{scope:"col",class:"border-0 text-center"},"單價"),t("td",{scope:"col",class:"border-0 text-center"},"小計"),t("td",{scope:"col",class:"border-0"})],-1)),(d(!0),c(S,null,H(s.value.carts,e=>(d(),c("tr",{key:e.id,class:"list-hover border-bottom"},[t("td",O,[a(g,{to:`/product/${e.product_id}`},{default:v(()=>[t("img",{src:e.product.image,loading:"lazy",alt:"",class:"rounded"},null,8,P)]),_:2},1032,["to"])]),t("td",Q,[a(g,{to:`/product/${e.product_id}`,style:{"text-transform":"capitalize"}},{default:v(()=>[m(i(e.product.title),1)]),_:2},1032,["to"])]),t("td",tt,i(e.qty),1),t("td",ot,[t("p",{class:u(["mb-0 text-end",{onsale:e.final_total!=e.product.price}])}," $"+i(e.product.price.toLocaleString()),3)]),t("td",et,[t("p",{class:u(["mb-0 text-end",{"text-danger":e.final_total!=e.product.price}])}," $"+i(e.final_total.toLocaleString()),3)]),t("td",st,[t("a",{href:"javascript:;",class:"close",onClick:ut=>$(e.id)},o[1]||(o[1]=[t("i",{class:"pi pi-times-circle"},null,-1)]),8,at)])]))),128))])],2)):(d(),c("div",rt,o[3]||(o[3]=[t("p",{class:"text-center",style:{"letter-spacing":"2px"}},"購物車內沒有商品",-1)]))),t("div",lt,[t("div",nt,[o[4]||(o[4]=t("p",{class:"h6 mb-2 small"},"➤ 開店慶輸入優惠碼 happy99 即可享九折優惠",-1)),t("div",ct,[a(I,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value=e),type:"text",placeholder:"請輸入優惠碼",class:"form-control text-danger",style:{"letter-spacing":"1px"}},null,8,["modelValue"]),a(L,{label:"套用優惠碼",severity:"contrast",onClick:y})])]),s.value?(d(),c("div",dt,[t("p",null,[o[5]||(o[5]=m(" 總金額： ")),t("span",{class:u({"text-danger":s.value.final_total!=s.value.total})}," $"+i(s.value.final_total.toLocaleString()),3),o[6]||(o[6]=m(" 元 "))])])):U("",!0)]),o[8]||(o[8]=t("hr",null,null,-1)),t("div",it,[a(g,{to:"/products",class:"btn btn-outline-secondary me-3 px-4",prefetch:""},{default:v(()=>o[7]||(o[7]=[m(" 繼續購物 ")])),_:1}),t("button",{type:"button",class:"btn btn-danger px-4",onClick:D},"前往結帳")])])])])]),a(N)],64)}}},Vt=z(pt,[["__scopeId","data-v-3c834c71"]]);export{Vt as default};
